/**
 * GoShopMe Mobile Optimization - Shared across ALL screens
 *
 * Mobile (<=768px)  -> full-width, edge-to-edge, no gutters
 * Desktop (>768px)  -> centered 390px mockup with shadow
 */

/* =============================================================
   1. BASE RESETS
   ============================================================= */
*, *::before, *::after { box-sizing: border-box; }

html, body {
  overflow-x: hidden;
  width: 100%;
  max-width: 100vw;
  -webkit-text-size-adjust: 100%;
  text-size-adjust: 100%;
}

html {
  min-height: 100%;
  min-height: -webkit-fill-available;
  min-height: 100dvh;
}
body {
  min-height: 100vh;
  min-height: -webkit-fill-available;
  min-height: 100dvh;
}

/* =============================================================
   2. HIDE SCROLLBARS EVERYWHERE
   ============================================================= */
::-webkit-scrollbar { display: none; }
* { scrollbar-width: none; -ms-overflow-style: none; }

/* =============================================================
   3. MOBILE: FULL-WIDTH, EDGE-TO-EDGE  (phones <= 768px)
   ============================================================= */
@media screen and (max-width: 768px) {

  /* --- 3a. White body - no gray gutters --- */
  html, body {
    background-color: #ffffff !important;
    margin: 0 !important;
    padding: 0 !important;
  }

  /* --- 3b. Main app wrappers: remove 390px cap --- */
  #app-shell,
  #auth-screen,
  #welcome_screen,
  #quiz-screen,
  #onboarding-screen,
  #main-content {
    max-width: 100vw !important;
    width: 100% !important;
    box-shadow: none !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
  }

  [id$="-screen"],
  [id$="-container"],
  [id$="-wrapper"],
  [id$="-page"] {
    max-width: 100vw !important;
    width: 100% !important;
    box-shadow: none !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
  }

  body > div,
  body > main {
    max-width: 100vw !important;
    width: 100% !important;
    box-shadow: none !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
  }

  /* Attribute selector for Tailwind max-w-[390px] */
  [class*="max-w-\[390px\]"],
  [class*="max-w-[390px]"] {
    max-width: 100vw !important;
    width: 100% !important;
  }

  /* --- 3c. Fixed headers --- */
  header,
  #header,
  [id$="-header"] {
    left: 0 !important;
    right: 0 !important;
    max-width: 100vw !important;
    width: 100% !important;
    transform: none !important;
  }

  /* --- 3d. Fixed bottom nav bars --- */
  nav,
  #bottom-nav,
  [id$="-nav"],
  [id$="-navigation"] {
    left: 0 !important;
    right: 0 !important;
    max-width: 100vw !important;
    width: 100% !important;
    transform: none !important;
  }

  /* --- 3e. Chat input bar and drawers --- */
  #chat-input-bar,
  #chat-drawer,
  [id$="-drawer"],
  [id$="-input-bar"],
  [id$="-chat-bar"] {
    left: 0 !important;
    right: 0 !important;
    max-width: 100vw !important;
    width: 100% !important;
  }

  /* Tailwind centering trick: left-1/2 + -translate-x-1/2 (exclude chat drawers/bars - they need transform for slide) */
  [class*="left-1/2"][class*="-translate-x-1/2"]:not([class*="rounded-full"]):not(#chat-drawer):not(#shai-chat-drawer):not(#chat-input-bar):not(#chat-overlay):not(#orders-chat-drawer):not(#orders-chat-input-bar):not(#return-chat-drawer):not(#return-chat-input-bar):not(#notif-chat-drawer):not(#notif-chat-input-bar) {
    left:      0 !important;
    right:     0 !important;
    max-width: 100vw !important;
    width:     100% !important;
    transform: none !important;
  }

  /* Re-apply Y slide so hidden drawers stay off-screen */
  [class*="left-1/2"][class*="-translate-x-1/2"][class*="translate-y-full"] {
    transform: translateY(100%) !important;
  }

  /* --- 3f. Main content --- */
  main,
  [id="main-content"],
  [id$="-content"] {
    max-width: 100vw !important;
    width: 100% !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
  }

  /* --- 3g. Bottom nav: push buttons UP away from the gesture bar ---
   * More bottom padding on the inner row pushes the icons upward
   * within the bar on Android gesture-nav phones (Pixel, Samsung etc.)
   */
  #bottom-nav > div,
  nav#bottom-nav > div,
  #bottom-navigation > div,
  nav#bottom-navigation > div {
    padding-top: 2px !important;
    padding-bottom: 24px !important;
  }

  /* Chat drawer and input bar: full-width, docked to bottom nav (no gap) */
  #chat-drawer,
  #chat-input-bar,
  #chat-input-collapsed,
  #shai-chat-drawer,
  #return-chat-drawer,
  #return-chat-input-bar,
  #orders-chat-drawer,
  #orders-chat-input-bar,
  #notif-chat-drawer,
  #notif-chat-input-bar,
  #shai-chat-drawer-wrapper,
  #chat-drawer-wrapper {
    left: 0 !important;
    right: 0 !important;
    max-width: 100vw !important;
    width: 100% !important;
    bottom: var(--shai-nav-h, 64px) !important;
    overscroll-behavior: contain;
  }

  /* Re-apply Y slide when drawer is hidden (translate-y-full) */
  #chat-drawer.translate-y-full,
  #shai-chat-drawer.translate-y-full,
  #return-chat-drawer.translate-y-full,
  #orders-chat-drawer.translate-y-full,
  #notif-chat-drawer.translate-y-full {
    transform: translateY(100%) !important;
  }

  /* Chat drawer max-height: 64px bottom-16 + 80px safe zone for browser/status bar */
  #chat-drawer,
  #shai-chat-drawer,
  #return-chat-drawer,
  #orders-chat-drawer,
  [id$="-drawer"] {
    max-height: calc(100dvh - 144px) !important;
  }

} /* end @media mobile */

/* =============================================================
   3b. CHAT DRAWER SCROLL & TOUCH (all viewports)
   ============================================================= */
/* Dock to bottom nav: no gap between drawer/input bar and nav */
#chat-drawer,
#chat-input-bar,
#shai-chat-drawer,
#return-chat-drawer,
#return-chat-input-bar,
#orders-chat-drawer,
#orders-chat-input-bar,
#notif-chat-drawer,
#notif-chat-input-bar {
  bottom: var(--shai-nav-h, 64px) !important;
}

#chat-drawer,
#shai-chat-drawer,
#return-chat-drawer,
#orders-chat-drawer,
[id$="-drawer"] {
  overscroll-behavior: contain;
  -webkit-overflow-scrolling: touch;
}

#chat-messages,
#return-chat-messages,
[id$="-chat-messages"],
[id$="-messages"] {
  overscroll-behavior: contain;
  -webkit-overflow-scrolling: touch;
}

/* Drag handle: prevent scroll on touch, optimize for dragging */
#drag-handle-zone,
.chat-drawer-drag-zone,
[id$="-drag-handle-area"] {
  touch-action: none;
  -webkit-user-select: none;
  user-select: none;
  -webkit-tap-highlight-color: transparent;
}

/* =============================================================
   4. DESKTOP: centered 390px mockup
   ============================================================= */
@media screen and (min-width: 769px) {
  body { background-color: #F6F6F6; }
}

/* =============================================================
   5. iOS INPUT ZOOM PREVENTION
   ============================================================= */
input,
input[type="text"],
input[type="email"],
input[type="password"],
input[type="tel"],
input[type="number"],
input[type="search"],
input[type="url"],
textarea,
select {
  font-size: 16px !important;
  -webkit-appearance: none;
  appearance: none;
}

@media screen and (min-width: 390px) {
  input,
  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="tel"],
  input[type="number"],
  input[type="search"],
  input[type="url"],
  textarea,
  select {
    font-size: 14px !important;
  }
}

/* =============================================================
   6. TOUCH IMPROVEMENTS
   ============================================================= */
a, button, [role="button"], input, select, textarea {
  touch-action: manipulation;
}

* { -webkit-tap-highlight-color: rgba(147, 155, 251, 0.10); }

/* =============================================================
   7. IMAGES & MEDIA
   ============================================================= */
img, video, iframe {
  max-width: 100%;
  display: block;
}

/* =============================================================
   8. HORIZONTAL CAROUSELS
   ============================================================= */
.overflow-x-auto,
[class*="overflow-x-auto"] {
  -webkit-overflow-scrolling: touch;
  overscroll-behavior-x: contain;
}

/* =============================================================
   9. LONG TEXT
   ============================================================= */
p, h1, h2, h3, h4, h5, h6, span, a, label {
  overflow-wrap: break-word;
  word-break: break-word;
}

/* =============================================================
   10. 320px PHONES
   ============================================================= */
@media screen and (max-width: 359px) {
  html { font-size: 14px; }
  .w-40 { width: 136px !important; }
  .w-44 { width: 150px !important; }
}

/* =============================================================
   11. LANDSCAPE ON SMALL PHONES
   ============================================================= */
@media screen and (orientation: landscape) and (max-height: 500px) {
  #app-shell,
  #auth-screen,
  [id$="-screen"] {
    height: auto !important;
    min-height: 100dvh;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }
}

/* =============================================================
   12. HELPER CLASSES
   ============================================================= */
.safe-area-bottom { padding-bottom: env(safe-area-inset-bottom, 0); }
.safe-area-top    { padding-top:    env(safe-area-inset-top,    0); }
